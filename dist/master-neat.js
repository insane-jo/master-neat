/*! For license information please see master-neat.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("child_process"),require("os")):"function"==typeof define&&define.amd?define(["child_process","os"],e):"object"==typeof exports?exports.MasterNeat=e(require("child_process"),require("os")):t.MasterNeat=e(t.child_process,t.os)}(self,((t,e)=>(()=>{"use strict";var n={975:t=>{function e(t){if("string"!=typeof t)throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}function n(t,e){for(var n,o="",i=0,s=-1,r=0,a=0;a<=t.length;++a){if(a<t.length)n=t.charCodeAt(a);else{if(47===n)break;n=47}if(47===n){if(s===a-1||1===r);else if(s!==a-1&&2===r){if(o.length<2||2!==i||46!==o.charCodeAt(o.length-1)||46!==o.charCodeAt(o.length-2))if(o.length>2){var u=o.lastIndexOf("/");if(u!==o.length-1){-1===u?(o="",i=0):i=(o=o.slice(0,u)).length-1-o.lastIndexOf("/"),s=a,r=0;continue}}else if(2===o.length||1===o.length){o="",i=0,s=a,r=0;continue}e&&(o.length>0?o+="/..":o="..",i=2)}else o.length>0?o+="/"+t.slice(s+1,a):o=t.slice(s+1,a),i=a-s-1;s=a,r=0}else 46===n&&-1!==r?++r:r=-1}return o}var o={resolve:function(){for(var t,o="",i=!1,s=arguments.length-1;s>=-1&&!i;s--){var r;s>=0?r=arguments[s]:(void 0===t&&(t=process.cwd()),r=t),e(r),0!==r.length&&(o=r+"/"+o,i=47===r.charCodeAt(0))}return o=n(o,!i),i?o.length>0?"/"+o:"/":o.length>0?o:"."},normalize:function(t){if(e(t),0===t.length)return".";var o=47===t.charCodeAt(0),i=47===t.charCodeAt(t.length-1);return 0!==(t=n(t,!o)).length||o||(t="."),t.length>0&&i&&(t+="/"),o?"/"+t:t},isAbsolute:function(t){return e(t),t.length>0&&47===t.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var t,n=0;n<arguments.length;++n){var i=arguments[n];e(i),i.length>0&&(void 0===t?t=i:t+="/"+i)}return void 0===t?".":o.normalize(t)},relative:function(t,n){if(e(t),e(n),t===n)return"";if((t=o.resolve(t))===(n=o.resolve(n)))return"";for(var i=1;i<t.length&&47===t.charCodeAt(i);++i);for(var s=t.length,r=s-i,a=1;a<n.length&&47===n.charCodeAt(a);++a);for(var u=n.length-a,l=r<u?r:u,c=-1,h=0;h<=l;++h){if(h===l){if(u>l){if(47===n.charCodeAt(a+h))return n.slice(a+h+1);if(0===h)return n.slice(a+h)}else r>l&&(47===t.charCodeAt(i+h)?c=h:0===h&&(c=0));break}var f=t.charCodeAt(i+h);if(f!==n.charCodeAt(a+h))break;47===f&&(c=h)}var d="";for(h=i+c+1;h<=s;++h)h!==s&&47!==t.charCodeAt(h)||(0===d.length?d+="..":d+="/..");return d.length>0?d+n.slice(a+c):(a+=c,47===n.charCodeAt(a)&&++a,n.slice(a))},_makeLong:function(t){return t},dirname:function(t){if(e(t),0===t.length)return".";for(var n=t.charCodeAt(0),o=47===n,i=-1,s=!0,r=t.length-1;r>=1;--r)if(47===(n=t.charCodeAt(r))){if(!s){i=r;break}}else s=!1;return-1===i?o?"/":".":o&&1===i?"//":t.slice(0,i)},basename:function(t,n){if(void 0!==n&&"string"!=typeof n)throw new TypeError('"ext" argument must be a string');e(t);var o,i=0,s=-1,r=!0;if(void 0!==n&&n.length>0&&n.length<=t.length){if(n.length===t.length&&n===t)return"";var a=n.length-1,u=-1;for(o=t.length-1;o>=0;--o){var l=t.charCodeAt(o);if(47===l){if(!r){i=o+1;break}}else-1===u&&(r=!1,u=o+1),a>=0&&(l===n.charCodeAt(a)?-1==--a&&(s=o):(a=-1,s=u))}return i===s?s=u:-1===s&&(s=t.length),t.slice(i,s)}for(o=t.length-1;o>=0;--o)if(47===t.charCodeAt(o)){if(!r){i=o+1;break}}else-1===s&&(r=!1,s=o+1);return-1===s?"":t.slice(i,s)},extname:function(t){e(t);for(var n=-1,o=0,i=-1,s=!0,r=0,a=t.length-1;a>=0;--a){var u=t.charCodeAt(a);if(47!==u)-1===i&&(s=!1,i=a+1),46===u?-1===n?n=a:1!==r&&(r=1):-1!==n&&(r=-1);else if(!s){o=a+1;break}}return-1===n||-1===i||0===r||1===r&&n===i-1&&n===o+1?"":t.slice(n,i)},format:function(t){if(null===t||"object"!=typeof t)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof t);return function(t,e){var n=e.dir||e.root,o=e.base||(e.name||"")+(e.ext||"");return n?n===e.root?n+o:n+"/"+o:o}(0,t)},parse:function(t){e(t);var n={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return n;var o,i=t.charCodeAt(0),s=47===i;s?(n.root="/",o=1):o=0;for(var r=-1,a=0,u=-1,l=!0,c=t.length-1,h=0;c>=o;--c)if(47!==(i=t.charCodeAt(c)))-1===u&&(l=!1,u=c+1),46===i?-1===r?r=c:1!==h&&(h=1):-1!==r&&(h=-1);else if(!l){a=c+1;break}return-1===r||-1===u||0===h||1===h&&r===u-1&&r===a+1?-1!==u&&(n.base=n.name=0===a&&s?t.slice(1,u):t.slice(a,u)):(0===a&&s?(n.name=t.slice(1,r),n.base=t.slice(1,u)):(n.name=t.slice(a,r),n.base=t.slice(a,u)),n.ext=t.slice(r,u)),a>0?n.dir=t.slice(0,a-1):s&&(n.dir="/"),n},sep:"/",delimiter:":",win32:null,posix:null};o.posix=o,t.exports=o},49:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(799)),s=o(n(72)),r=o(n(864)),a=o(n(33)),u=o(n(712)),l=n(483),c=o(n(183)),h=o(n(57)),f=o(n(827)),d=o(n(308)),p=o(n(684));var g={Construct:function(t){var e,n=new s.default(0,0),o=[];for(e=0;e<t.length;e++){let n;if(t[e]instanceof a.default)for(n=0;n<t[e].nodes.length;n++)o.push(t[e].nodes[n]);else if(t[e]instanceof r.default)for(n=0;n<t[e].nodes.length;n++)for(var i=0;i<t[e].nodes[n].nodes.length;i++)o.push(t[e].nodes[n].nodes[i]);else t[e]instanceof u.default&&o.push(t[e])}var c=[],h=[];for(e=o.length-1;e>=0;e--)o[e].type===l.NodeTypeEnum.output||o[e].connections.out.length+o[e].connections.gated.length===0?(o[e].type=l.NodeTypeEnum.output,n.output++,h.push(o[e]),o.splice(e,1)):o[e].type!==l.NodeTypeEnum.input&&o[e].connections.in.length||(o[e].type=l.NodeTypeEnum.input,n.input++,c.push(o[e]),o.splice(e,1));if(o=c.concat(o).concat(h),0===n.input||0===n.output)throw new Error("Given nodes have no clear input/output node!");for(e=0;e<o.length;e++){let t;for(t=0;t<o[e].connections.out.length;t++)n.connections.push(o[e].connections.out[t]);for(t=0;t<o[e].connections.gated.length;t++)n.gates.push(o[e].connections.gated[t]);0!==o[e].connections.self.weight&&n.selfconns.push(o[e].connections.self)}return n.nodes=o,n},Perceptron:function(...t){var e=Array.prototype.slice.call(t);if(e.length<3)throw new Error("You have to specify at least 3 layers");var n=[];n.push(new a.default(e[0]));for(var o=1;o<e.length;o++){var s=e[o];s=new a.default(s),n.push(s),n[o-1].connect(n[o],i.default.connection.ALL_TO_ALL)}return g.Construct(n)},Random:function(t,e,n,o){var i,r=(o=o||{}).connections||2*e,a=o.backconnections||0,u=o.selfconnections||0,l=o.gates||0,g=new s.default(t,n);for(i=0;i<e;i++)g.mutate(c.default);for(i=0;i<r-e;i++)g.mutate(h.default);for(i=0;i<a;i++)g.mutate(f.default);for(i=0;i<u;i++)g.mutate(d.default);for(i=0;i<l;i++)g.mutate(p.default);return g},LSTM:function(...t){var e=Array.prototype.slice.call(t);if(e.length<3)throw new Error("You have to specify at least 3 layers");var n,o=e.pop();"number"==typeof o?(n=new a.default(o),o={}):n=new a.default(e.pop()),n.set({type:l.NodeTypeEnum.output});var s=o.memoryToMemory||!1,r=o.outputToMemory||!1,u=o.outputToGates||!1,c=void 0===o.inputToOutput||o.inputToOutput,h=void 0===o.inputToDeep||o.inputToDeep,f=new a.default(e.shift());f.set({type:l.NodeTypeEnum.input});var d=e,p=[];p.push(f);for(var v=f,m=0;m<d.length;m++){var _=d[m],w=new a.default(_),O=new a.default(_),M=new a.default(_),b=new a.default(_),y=m===d.length-1?n:new a.default(_);w.set({bias:1}),O.set({bias:1}),b.set({bias:1});var T=v.connect(M,i.default.connection.ALL_TO_ALL);v.connect(w,i.default.connection.ALL_TO_ALL),v.connect(b,i.default.connection.ALL_TO_ALL),v.connect(O,i.default.connection.ALL_TO_ALL),M.connect(w,i.default.connection.ALL_TO_ALL),M.connect(O,i.default.connection.ALL_TO_ALL),M.connect(b,i.default.connection.ALL_TO_ALL);var N=M.connect(M,i.default.connection.ONE_TO_ONE),A=M.connect(y,i.default.connection.ALL_TO_ALL);if(w.gate(T,i.default.gating.INPUT),O.gate(N,i.default.gating.SELF),b.gate(A,i.default.gating.OUTPUT),h&&m>0){let t=f.connect(M,i.default.connection.ALL_TO_ALL);w.gate(t,i.default.gating.INPUT)}if(s){let t=M.connect(M,i.default.connection.ALL_TO_ELSE);w.gate(t,i.default.gating.INPUT)}if(r){let t=n.connect(M,i.default.connection.ALL_TO_ALL);w.gate(t,i.default.gating.INPUT)}u&&(n.connect(w,i.default.connection.ALL_TO_ALL),n.connect(O,i.default.connection.ALL_TO_ALL),n.connect(b,i.default.connection.ALL_TO_ALL)),p.push(w),p.push(O),p.push(M),p.push(b),m!==d.length-1&&p.push(y),v=y}return c&&f.connect(n,i.default.connection.ALL_TO_ALL),p.push(n),g.Construct(p)},GRU:function(...t){var e=Array.prototype.slice.call(t);if(e.length<3)throw new Error("not enough layers (minimum 3) !!");var n=new a.default(e.shift()),o=new a.default(e.pop()),i=e,s=[];s.push(n);for(var u=n,l=0;l<i.length;l++){var c=r.default.GRU(i[l]);u.connect(c),u=c,s.push(c)}return u.connect(o),s.push(o),g.Construct(s)},Hopfield:function(t){var e=new a.default(t),n=new a.default(t);return e.connect(n,i.default.connection.ALL_TO_ALL),e.set({type:l.NodeTypeEnum.input}),n.set({squash:i.default.activation.STEP,type:l.NodeTypeEnum.output}),g.Construct([e,n])},NARX:function(t,e,n,o,s){Array.isArray(e)||(e=[e]);var a=[],c=r.default.Dense(t),h=r.default.Memory(t,o),f=[],d=r.default.Dense(n),p=r.default.Memory(n,s);a.push(c),a.push(p);for(var v=0;v<e.length;v++){var m=r.default.Dense(e[v]);f.push(m),a.push(m),void 0!==f[v-1]&&f[v-1].connect(m,i.default.connection.ALL_TO_ALL)}return a.push(h),a.push(d),c.connect(f[0],i.default.connection.ALL_TO_ALL),c.connect(h,i.default.connection.ONE_TO_ONE,1),h.connect(f[0],i.default.connection.ALL_TO_ALL),f[f.length-1].connect(d,i.default.connection.ALL_TO_ALL),d.connect(p,i.default.connection.ONE_TO_ONE,1),p.connect(f[0],i.default.connection.ALL_TO_ALL),c.set(new u.default(l.NodeTypeEnum.input)),d.set(new u.default(l.NodeTypeEnum.output)),g.Construct(a)}};e.default=g},292:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e,n){this.gain=1,this.elegibility=0,this.previousDeltaWeight=0,this.totalDeltaWeight=0,this.gater=null,this.xtrace={nodes:[],values:[]},this.from=t,this.to=e,this.weight=void 0===n?.2*Math.random()-.1:n}toJSON(){return{weight:this.weight}}static innovationID(t,e){return.5*(t+e)*(t+e+1)+e}}},33:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(712)),s=o(n(799)),r=o(n(864)),a=o(n(28));class u{constructor(t){this.nodes=[],this.connections={in:[],out:[],self:[]};for(var e=0;e<t;e++)this.nodes.push(new i.default)}activate(t){const e=[];if(void 0!==t&&t.length!==this.nodes.length)throw new Error("Array with values should be same as the amount of nodes!");for(let n=0;n<this.nodes.length;n++){let o;o=void 0===t?this.nodes[n].activate():this.nodes[n].activate(t[n]),e.push(o)}return e}propagate(t,e,n){if(void 0!==n&&n.length!==this.nodes.length)throw new Error("Array with values should be same as the amount of nodes!");for(var o=this.nodes.length-1;o>=0;o--)void 0===n?this.nodes[o].propagate(t,e,!0):this.nodes[o].propagate(t,e,!0,n[o])}connect(t,e,n){var o,i,l=[];if(t instanceof u){if(void 0===e&&(this!==t?(a.default.warnings&&console.warn("No group connection specified, using ALL_TO_ALL"),e=s.default.connection.ALL_TO_ALL):(a.default.warnings&&console.warn("No group connection specified, using ONE_TO_ONE"),e=s.default.connection.ONE_TO_ONE)),e===s.default.connection.ALL_TO_ALL||e===s.default.connection.ALL_TO_ELSE)for(o=0;o<this.nodes.length;o++)for(i=0;i<t.nodes.length;i++){if(e===s.default.connection.ALL_TO_ELSE&&this.nodes[o]===t.nodes[i])continue;let r=this.nodes[o].connect(t.nodes[i],n);this.connections.out.push(r[0]),t.connections.in.push(r[0]),l.push(r[0])}else if(e===s.default.connection.ONE_TO_ONE){if(this.nodes.length!==t.nodes.length)throw new Error("From and To group must be the same size!");for(o=0;o<this.nodes.length;o++){let e=this.nodes[o].connect(t.nodes[o],n);this.connections.self.push(e[0]),l.push(e[0])}}}else if(t instanceof r.default)l=t.input(this,e,n);else for(o=0;o<this.nodes.length;o++){let e=this.nodes[o].connect(t,n);this.connections.out.push(e[0]),l.push(e[0])}return l}gate(t,e){if(void 0===e)throw new Error("Please specify Gating.INPUT, Gating.OUTPUT");Array.isArray(t)||(t=[t]);const n=[],o=[];var i,r;for(i=0;i<t.length;i++){var a=t[i];n.includes(a.from)||n.push(a.from),o.includes(a.to)||o.push(a.to)}switch(e){case s.default.gating.INPUT:for(i=0;i<o.length;i++){let e=o[i],n=this.nodes[i%this.nodes.length];for(r=0;r<e.connections.in.length;r++){let o=e.connections.in[r];t.includes(o)&&n.gate(o)}}break;case s.default.gating.OUTPUT:for(i=0;i<n.length;i++){let e=n[i],o=this.nodes[i%this.nodes.length];for(r=0;r<e.connections.out.length;r++){let n=e.connections.out[r];t.includes(n)&&o.gate(n)}}break;case s.default.gating.SELF:for(i=0;i<n.length;i++){let e=n[i],o=this.nodes[i%this.nodes.length];t.includes(e.connections.self)&&o.gate(e.connections.self)}}}set(t){for(var e=0;e<this.nodes.length;e++)void 0!==t.bias&&(this.nodes[e].bias=t.bias),this.nodes[e].squash=t.squash||this.nodes[e].squash,this.nodes[e].type=t.type||this.nodes[e].type}disconnect(t,e=!1){var n,o,i;if(t instanceof u)for(n=0;n<this.nodes.length;n++)for(o=0;o<t.nodes.length;o++){for(this.nodes[n].disconnect(t.nodes[o],e),i=this.connections.out.length-1;i>=0;i--){let e=this.connections.out[i];if(e.from===this.nodes[n]&&e.to===t.nodes[o]){this.connections.out.splice(i,1);break}}if(e)for(i=this.connections.in.length-1;i>=0;i--){let e=this.connections.in[i];if(e.from===t.nodes[o]&&e.to===this.nodes[n]){this.connections.in.splice(i,1);break}}}else for(n=0;n<this.nodes.length;n++){for(this.nodes[n].disconnect(t,e),o=this.connections.out.length-1;o>=0;o--){let e=this.connections.out[o];if(e.from===this.nodes[n]&&e.to===t){this.connections.out.splice(o,1);break}}if(e)for(o=this.connections.in.length-1;o>=0;o--){var s=this.connections.in[o];if(s.from===t&&s.to===this.nodes[n]){this.connections.in.splice(o,1);break}}}}clear(){for(var t=0;t<this.nodes.length;t++)this.nodes[t].clear()}}e.default=u},864:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(33)),s=o(n(712)),r=o(n(799)),a=n(483);class u{constructor(){this.output=null,this.nodes=[],this.connections={in:[],out:[],self:[]},this.input=()=>{}}activate(t){var e=[];if(void 0!==t&&t.length!==this.nodes.length)throw new Error("Array with values should be same as the amount of nodes!");for(var n=0;n<this.nodes.length;n++){var o;o=void 0===t?this.nodes[n].activate():this.nodes[n].activate(t[n]),e.push(o)}return e}propagate(t,e,n){if(void 0!==n&&n.length!==this.nodes.length)throw new Error("Array with values should be same as the amount of nodes!");for(var o=this.nodes.length-1;o>=0;o--)void 0===n?this.nodes[o].propagate(t,e,!0):this.nodes[o].propagate(t,e,!0,n[o])}connect(t,e,n){return t instanceof i.default||t instanceof s.default?this.output.connect(t,e,n):t.input(this,e,n)}gate(t,e){this.output.gate(t,e)}set(t){for(var e=0;e<this.nodes.length;e++){const n=this.nodes[e];n instanceof s.default?(void 0!==t.bias&&(n.bias=t.bias),n.squash=t.squash||n.squash,n.type=t.type||n.type):n.set(t)}}disconnect(t,e=!1){var n,o,s;if(t instanceof i.default)for(n=0;n<this.nodes.length;n++)for(o=0;o<t.nodes.length;o++){for(this.nodes[n].disconnect(t.nodes[o],e),s=this.connections.out.length-1;s>=0;s--){let e=this.connections.out[s];if(e.from===this.nodes[n]&&e.to===t.nodes[o]){this.connections.out.splice(s,1);break}}if(e)for(s=this.connections.in.length-1;s>=0;s--){let e=this.connections.in[s];if(e.from===t.nodes[o]&&e.to===this.nodes[n]){this.connections.in.splice(s,1);break}}}else for(n=0;n<this.nodes.length;n++){for(this.nodes[n].disconnect(t,e),o=this.connections.out.length-1;o>=0;o--){let e=this.connections.out[o];if(e.from===this.nodes[n]&&e.to===t){this.connections.out.splice(o,1);break}}if(e)for(s=this.connections.in.length-1;s>=0;s--){let e=this.connections.in[s];if(e.from===t&&e.to===this.nodes[n]){this.connections.in.splice(s,1);break}}}}clear(){for(var t=0;t<this.nodes.length;t++)this.nodes[t].clear()}static Dense(t){var e=new u,n=new i.default(t);return e.nodes.push(n),e.output=n,e.input=function(t,e,o){return e=e||r.default.connection.ALL_TO_ALL,t.connect(n,e,o)},e}static LSTM(t){var e=new u,n=new i.default(t),o=new i.default(t),s=new i.default(t),a=new i.default(t),l=new i.default(t);n.set({bias:1}),o.set({bias:1}),a.set({bias:1}),s.connect(n,r.default.connection.ALL_TO_ALL),s.connect(o,r.default.connection.ALL_TO_ALL),s.connect(a,r.default.connection.ALL_TO_ALL);var c=s.connect(s,r.default.connection.ONE_TO_ONE),h=s.connect(l,r.default.connection.ALL_TO_ALL);return o.gate(c,r.default.gating.SELF),a.gate(h,r.default.gating.OUTPUT),e.nodes=[n,o,s,a,l],e.output=l,e.input=function(t,e,i){e=e||r.default.connection.ALL_TO_ALL;var u=[],l=t.connect(s,e,i);return u=(u=(u=(u=u.concat(l)).concat(t.connect(n,e,i))).concat(t.connect(a,e,i))).concat(t.connect(o,e,i)),n.gate(l,r.default.gating.INPUT),u},e}static GRU(t){var e=new u,n=new i.default(t),o=new i.default(t),s=new i.default(t),l=new i.default(t),c=new i.default(t),h=new i.default(t);h.set({bias:0,squash:r.default.activation.IDENTITY,type:a.NodeTypeEnum.constant}),l.set({squash:r.default.activation.TANH}),o.set({bias:0,squash:r.default.activation.INVERSE,type:a.NodeTypeEnum.constant}),n.set({bias:1}),s.set({bias:0}),h.connect(n,r.default.connection.ALL_TO_ALL),n.connect(o,r.default.connection.ONE_TO_ONE,1),h.connect(s,r.default.connection.ALL_TO_ALL);var f=h.connect(l,r.default.connection.ALL_TO_ALL);s.gate(f,r.default.gating.OUTPUT);var d=h.connect(c,r.default.connection.ALL_TO_ALL),p=l.connect(c,r.default.connection.ALL_TO_ALL);return n.gate(d,r.default.gating.OUTPUT),o.gate(p,r.default.gating.OUTPUT),c.connect(h,r.default.connection.ONE_TO_ONE,1),e.nodes=[n,o,s,l,c,h],e.output=c,e.input=function(t,e,o){t instanceof u&&(t=t.output),e=e||r.default.connection.ALL_TO_ALL;var i=[];return(i=(i=i.concat(t.connect(n,e,o))).concat(t.connect(s,e,o))).concat(t.connect(l,e,o))},e}static Memory(t,e){var n,o=new u,s=null;for(n=0;n<e;n++){var l=new i.default(t);l.set({squash:r.default.activation.IDENTITY,bias:0,type:a.NodeTypeEnum.constant}),null!=s&&s.connect(l,r.default.connection.ONE_TO_ONE,1),o.nodes.push(l),s=l}for(o.nodes.reverse(),n=0;n<o.nodes.length;n++)o.nodes[n].nodes.reverse();var c=new i.default(0);for(var h in o.nodes)c.nodes=c.nodes.concat(o.nodes[h].nodes);return o.output=c,o.input=function(t,e,n){if(t instanceof u&&(t=t.output),e=e||r.default.connection.ALL_TO_ALL,t.nodes.length!==o.nodes[o.nodes.length-1].nodes.length)throw new Error("Previous layer size must be same as memory size");return t.connect(o.nodes[o.nodes.length-1],e,n)},o}}e.default=u},72:function(t,e,n){var o,i=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(e,n);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,o,i)}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=this&&this.__importStar||(o=function(t){return o=Object.getOwnPropertyNames||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[e.length]=n);return e},o(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n=o(t),r=0;r<n.length;r++)"default"!==n[r]&&i(e,t,n[r]);return s(e,t),e}),a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(i,s){function r(t){try{u(o.next(t))}catch(t){s(t)}}function a(t){try{u(o.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}u((o=o.apply(t,e||[])).next())}))},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const l=u(n(292)),c=u(n(712)),h=r(n(224)),f=u(n(799)),d=u(n(28)),p=u(n(582)),g=n(483),v=u(n(492));class m{constructor(t,e){if(void 0===t||void 0===e)throw new Error("No input or output size given");this.input=t,this.output=e,this.nodes=[],this.connections=[],this.gates=[],this.selfconns=[],this.dropout=0;for(let t=0;t<this.input+this.output;t++){var n=t<this.input?g.NodeTypeEnum.input:g.NodeTypeEnum.output;this.nodes.push(new c.default(n))}for(let t=0;t<this.input;t++)for(var o=this.input;o<this.output+this.input;o++){var i=Math.random()*this.input*Math.sqrt(2/this.input);this.connect(this.nodes[t],this.nodes[o],i)}}activate(t,e){for(var n=[],o=0;o<this.nodes.length;o++)if(this.nodes[o].type===g.NodeTypeEnum.input)this.nodes[o].activate(t[o]);else if(this.nodes[o].type===g.NodeTypeEnum.output){var i=this.nodes[o].activate();n.push(i)}else e&&(this.nodes[o].mask=Math.random()<this.dropout?0:1),this.nodes[o].activate();return n}noTraceActivate(t){for(var e=[],n=0;n<this.nodes.length;n++)if(this.nodes[n].type===g.NodeTypeEnum.input)this.nodes[n].noTraceActivate(t[n]);else if(this.nodes[n].type===g.NodeTypeEnum.output){var o=this.nodes[n].noTraceActivate();e.push(o)}else this.nodes[n].noTraceActivate();return e}propagate(t,e,n,o){if(void 0===o||o.length!==this.output)throw new Error("Output target length should match network output length");var i,s=o.length;for(i=this.nodes.length-1;i>=this.nodes.length-this.output;i--)this.nodes[i].propagate(t,e,n,o[--s]);for(i=this.nodes.length-this.output-1;i>=this.input;i--)this.nodes[i].propagate(t,e,n)}clear(){for(var t=0;t<this.nodes.length;t++)this.nodes[t].clear()}connect(t,e,n){const o=t.connect(e,n);for(let n=0;n<o.length;n++){const i=o[n];t!==e?this.connections.push(i):this.selfconns.push(i)}return o}disconnect(t,e){for(var n=t===e?this.selfconns:this.connections,o=0;o<n.length;o++){var i=n[o];if(i.from===t&&i.to===e){null!==i.gater&&this.ungate(i),n.splice(o,1);break}}t.disconnect(e)}gate(t,e){if(-1===this.nodes.indexOf(t))throw new Error("This node is not part of the network!");null==e.gater?(t.gate(e),this.gates.push(e)):d.default.warnings&&console.warn("This connection is already gated!")}ungate(t){var e,n=this.gates.indexOf(t);if(-1===n)throw new Error("This connection is not gated!");this.gates.splice(n,1),null===(e=t.gater)||void 0===e||e.ungate(t)}remove(t){var e=this.nodes.indexOf(t);if(-1===e)throw new Error("This node does not exist in the network!");var n=[];this.disconnect(t,t);for(var o=[],i=t.connections.in.length-1;i>=0;i--){let e=t.connections.in[i];v.default.keep_gates&&null!==e.gater&&e.gater!==t&&n.push(e.gater),o.push(e.from),this.disconnect(e.from,t)}var s=[];for(i=t.connections.out.length-1;i>=0;i--){let e=t.connections.out[i];v.default.keep_gates&&null!==e.gater&&e.gater!==t&&n.push(e.gater),s.push(e.to),this.disconnect(t,e.to)}var r=[];for(i=0;i<o.length;i++){let t=o[i];for(var a=0;a<s.length;a++){let e=s[a];if(!t.isProjectingTo(e)){var u=this.connect(t,e);r.push(u[0])}}}for(i=0;i<n.length&&0!==r.length;i++){let t=n[i],e=Math.floor(Math.random()*r.length);this.gate(t,r[e]),r.splice(e,1)}for(i=t.connections.gated.length-1;i>=0;i--){let e=t.connections.gated[i];this.ungate(e)}this.disconnect(t,t),this.nodes.splice(e,1)}mutate(t){if(void 0===t)throw new Error("No (correct) mutate method given!");t.callback(this)}train(t,e={}){if(t[0].input.length!==this.input||t[0].output.length!==this.output)throw new Error("Dataset input/output size should be same as network input/output size!");void 0===e.rate&&d.default.warnings&&console.warn("Using default learning rate, please define a rate!"),void 0===e.iterations&&d.default.warnings&&console.warn("No target iterations given, running until error is reached!");var n=e.error||.05,o=e.cost||f.default.cost.MSE,i=e.rate||.3,s=e.dropout||0,r=e.momentum||0,a=e.batchSize||1,u=e.ratePolicy||f.default.rate.FIXED(),l=Date.now();if(a>t.length)throw new Error("Batch size must be smaller or equal to dataset length!");if(void 0===e.iterations&&void 0===e.error)throw new Error("At least one of the following options must be specified: error, iterations");void 0===e.error?n=-1:void 0===e.iterations&&(e.iterations=0),this.dropout=s;let c=[],h=[];if(e.crossValidate){let n=Math.ceil((1-e.crossValidate.testSize)*t.length);c=t.slice(0,n),h=t.slice(n)}for(var p=i,v=0,m=1;m>n&&(0===e.iterations||v<e.iterations)&&!(e.crossValidate&&m<=e.crossValidate.testError);){if(p=u(i,++v),e.crossValidate?(this._trainSet(c,a,p,r,o),e.clear&&this.clear(),m=this.test(h,o).error,e.clear&&this.clear()):(m=this._trainSet(t,a,p,r,o),e.clear&&this.clear()),e.shuffle)for(let e,n,o=t.length;o;e=Math.floor(Math.random()*o),n=t[--o],t[o]=t[e],t[e]=n);e.log&&v%e.log==0&&console.log("iteration",v,"error",m,"rate",p),e.schedule&&v%e.schedule.iterations==0&&e.schedule.function({error:m,iteration:v})}if(e.clear&&this.clear(),s)for(let t=0;t<this.nodes.length;t++)this.nodes[t].type!==g.NodeTypeEnum.hidden&&this.nodes[t].type!==g.NodeTypeEnum.constant||(this.nodes[t].mask=1-this.dropout);return{error:m,iterations:v,time:Date.now()-l}}_trainSet(t,e,n,o,i){let s=0;for(var r=0;r<t.length;r++){const a=t[r].input,u=t[r].output,l=(r+1)%e==0||r+1===t.length,c=this.activate(a,!0);this.propagate(n,o,l,u),s+=i(u,c)}return s/t.length}test(t,e=f.default.cost.MSE){var n;if(this.dropout)for(n=0;n<this.nodes.length;n++)this.nodes[n].type!==g.NodeTypeEnum.hidden&&this.nodes[n].type!==g.NodeTypeEnum.constant||(this.nodes[n].mask=1-this.dropout);var o=0,i=Date.now();for(n=0;n<t.length;n++){let i=t[n].input;o+=e(t[n].output,this.noTraceActivate(i))}return{error:o/=t.length,time:Date.now()-i}}toJSON(){var t={nodes:[],connections:[],input:this.input,output:this.output,dropout:this.dropout};for(let t=0;t<this.nodes.length;t++)this.nodes[t].index=t;for(let e=0;e<this.nodes.length;e++){let n=this.nodes[e],o=n.toJSON();if(o.index=e,t.nodes.push(o),0!==n.connections.self.weight){let o=n.connections.self.toJSON();o.from=e,o.to=e,o.gater=null!=n.connections.self.gater?n.connections.self.gater.index:null,t.connections.push(o)}}for(let e=0;e<this.connections.length;e++){let n=this.connections[e],o=n.toJSON();o.from=n.from.index,o.to=n.to.index,o.gater=null!=n.gater?n.gater.index:null,t.connections.push(o)}return t}set(t){for(var e=0;e<this.nodes.length;e++)this.nodes[e].bias=t.bias||this.nodes[e].bias,this.nodes[e].squash=t.squash||this.nodes[e].squash}evolve(t,e){return a(this,void 0,void 0,(function*(){if(t[0].input.length!==this.input||t[0].output.length!==this.output)throw new Error("Dataset input/output size should be same as network input/output size!");var o=void 0!==(e=e||{}).error?e.error:.05,i=void 0!==e.growth?e.growth:1e-4,s=e.cost||f.default.cost.MSE,r=e.amount||1,a=e.threads;void 0===a&&(a="undefined"==typeof window?n(234).cpus().length:navigator.hardwareConcurrency);var u,l=Date.now();if(void 0===e.iterations&&void 0===e.error)throw new Error("At least one of the following options must be specified: error, iterations");if(void 0===e.error?o=-1:void 0===e.iterations&&(e.iterations=0),1===a)u=function(e){for(var n=0,o=0;o<r;o++)n-=e.test(t,s).error;return n-=(e.nodes.length-e.input-e.output+e.connections.length+e.gates.length)*i,(n=isNaN(n)?-1/0:n)/r};else{var c=h.serializeDataSet(t);const n=[];if("undefined"==typeof window)for(let t=0;t<a;t++)n.push(new h.workers.node.TestWorker(c,s));else for(let t=0;t<a;t++)n.push(new h.workers.browser.TestWorker(c,s));u=function(t){return new Promise((e=>{for(var o=t.slice(),s=0,r=function(t){if(o.length){var n=o.shift();t.evaluate(n).then((function(e){n.score=-e,n.score-=(n.nodes.length-n.input-n.output+n.connections.length+n.gates.length)*i,n.score=isNaN(parseFloat(e))?-1/0:n.score,r(t)}))}else++s===a&&e(void 0)},u=0;u<n.length;u++)r(n[u])}))},e.fitnessPopulation=!0}e.network=this;for(var d,g=new p.default(this.input,this.output,u,e),v=-1/0,m=-1/0;v<-o&&(0===e.iterations||g.generation<e.iterations);){let t=yield g.evolve(),n=t.score;v=n+(t.nodes.length-t.input-t.output+t.connections.length+t.gates.length)*i,n>m&&(m=n,d=t),e.log&&g.generation%e.log==0&&console.log("iteration",g.generation,"fitness",n,"error",-v),e.schedule&&g.generation%e.schedule.iterations==0&&e.schedule.function({fitness:n,error:-v,iteration:g.generation})}if(a>1)for(var _=0;_<workers.length;_++)workers[_].terminate();return void 0!==d&&(this.nodes=d.nodes,this.connections=d.connections,this.selfconns=d.selfconns,this.gates=d.gates,e.clear&&this.clear()),{error:-v,iterations:g.generation,time:Date.now()-l}}))}standalone(){var t,e=[],n=[],o=[],i=[],s=[];for(t=0;t<this.input;t++){var r=this.nodes[t];n.push(r.activation),o.push(r.state)}for(i.push("for(var i = 0; i < input.length; i++) A[i] = input[i];"),t=0;t<this.nodes.length;t++)this.nodes[t].index=t;for(t=this.input;t<this.nodes.length;t++){let r=this.nodes[t];n.push(r.activation),o.push(r.state);var a=e.indexOf(r.squash.name);-1===a&&(a=e.length,e.push(r.squash.name),s.push(r.squash.toString()));for(var u=[],l=0;l<r.connections.in.length;l++){var c=r.connections.in[l],h=`A[${c.from.index}] * ${c.weight}`;null!=c.gater&&(h+=` * A[${c.gater.index}]`),u.push(h)}if(r.connections.self.weight){let e=r.connections.self,n=`S[${t}] * ${e.weight}`;null!=e.gater&&(n+=` * A[${e.gater.index}]`),u.push(n)}var f=`S[${t}] = ${u.join(" + ")} + ${r.bias};`,d=`A[${t}] = F[${a}](S[${t}])${r.mask?"":" * "+r.mask};`;i.push(f),i.push(d)}var p=[];for(t=this.nodes.length-this.output;t<this.nodes.length;t++)p.push(`A[${t}]`);i.push(`return [${p.join(",")}];`);var g="";return g+=`var F = [${s.toString()}];\r\n`,g+=`var A = [${n.toString()}];\r\n`,(g+=`var S = [${o.toString()}];\r\n`)+`activate = function(input){\r\n${i.join("\r\n")}\r\n}`}serialize(){var t,e=[],n=[],o=[],i=["LOGISTIC","TANH","IDENTITY","STEP","RELU","SOFTSIGN","SINUSOID","GAUSSIAN","BENT_IDENTITY","BIPOLAR","BIPOLAR_SIGMOID","HARD_TANH","ABSOLUTE","INVERSE","SELU"];for(o.push(this.input),o.push(this.output),t=0;t<this.nodes.length;t++){let o=this.nodes[t];o.index=t,e.push(o.activation),n.push(o.state)}for(t=this.input;t<this.nodes.length;t++){let e=this.nodes[t];o.push(e.index),o.push(e.bias),o.push(i.indexOf(e.squash.name)),o.push(e.connections.self.weight),o.push(null==e.connections.self.gater?-1:e.connections.self.gater.index);for(var s=0;s<e.connections.in.length;s++){let t=e.connections.in[s];o.push(t.from.index),o.push(t.weight),o.push(null==t.gater?-1:t.gater.index)}o.push(-2)}return[e,n,o]}static fromJSON(t){var e,n=new m(t.input,t.output);for(n.dropout=t.dropout,n.nodes=[],n.connections=[],e=0;e<t.nodes.length;e++)n.nodes.push(c.default.fromJSON(t.nodes[e]));for(e=0;e<t.connections.length;e++){var o=t.connections[e],i=n.connect(n.nodes[o.from],n.nodes[o.to])[0];i.weight=o.weight,null!=o.gater&&n.gate(n.nodes[o.gater],i)}return n}static merge(t,e){if(t=m.fromJSON(t.toJSON()),e=m.fromJSON(e.toJSON()),t.output!==e.input)throw new Error("Output size of network1 should be the same as the input size of network2!");var n;for(n=0;n<e.connections.length;n++){let o=e.connections[n];if(o.from.type===g.NodeTypeEnum.input){let n=e.nodes.indexOf(o.from);o.from=t.nodes[t.nodes.length-1-n]}}for(n=e.input-1;n>=0;n--)e.nodes.splice(n,1);for(n=t.nodes.length-t.output;n<t.nodes.length;n++)t.nodes[n].type=g.NodeTypeEnum.hidden;return t.connections=t.connections.concat(e.connections),t.nodes=t.nodes.concat(e.nodes),t}static crossOver(t,e,n){if(t.input!==e.input||t.output!==e.output)throw new Error("Networks don't have the same input/output size!");var o=new m(t.input,t.output);o.connections=[],o.nodes=[];var i,s=t.score||0,r=e.score||0;if(n||s===r){let n=Math.max(t.nodes.length,e.nodes.length),o=Math.min(t.nodes.length,e.nodes.length);i=Math.floor(Math.random()*(n-o+1)+o)}else i=s>r?t.nodes.length:e.nodes.length;var a,u=t.output;for(a=0;a<t.nodes.length;a++)t.nodes[a].index=a;for(a=0;a<e.nodes.length;a++)e.nodes[a].index=a;for(a=0;a<i;a++){var h;if(a<i-u){let n=Math.random();h=n>=.5?t.nodes[a]:e.nodes[a];let o=n<.5?t.nodes[a]:e.nodes[a];void 0!==h&&h.type!==g.NodeTypeEnum.output||(h=o)}else h=Math.random()>=.5?t.nodes[t.nodes.length+a-i]:e.nodes[e.nodes.length+a-i];var f=new c.default;f.bias=h.bias,f.squash=h.squash,f.type=h.type,o.nodes.push(f)}var d={},p={};for(a=0;a<t.connections.length;a++){let e=t.connections[a],n={weight:e.weight,from:e.from.index,to:e.to.index,gater:null!=e.gater?e.gater.index:-1};d[l.default.innovationID(n.from,n.to)]=n}for(a=0;a<t.selfconns.length;a++){let e=t.selfconns[a],n={weight:e.weight,from:e.from.index,to:e.to.index,gater:null!=e.gater?e.gater.index:-1};d[l.default.innovationID(n.from,n.to)]=n}for(a=0;a<e.connections.length;a++){let t=e.connections[a],n={weight:t.weight,from:t.from.index,to:t.to.index,gater:null!=t.gater?t.gater.index:-1};p[l.default.innovationID(n.from,n.to)]=n}for(a=0;a<e.selfconns.length;a++){let t=e.selfconns[a],n={weight:t.weight,from:t.from.index,to:t.to.index,gater:null!=t.gater?t.gater.index:-1};p[l.default.innovationID(n.from,n.to)]=n}var v=[],_=Object.keys(d),w=Object.keys(p);for(a=_.length-1;a>=0;a--)if(void 0!==p[_[a]]){let t=Math.random()>=.5?d[_[a]]:p[_[a]];v.push(t),p[_[a]]=void 0}else(s>=r||n)&&v.push(d[_[a]]);if(r>=s||n)for(a=0;a<w.length;a++)void 0!==p[w[a]]&&v.push(p[w[a]]);for(a=0;a<v.length;a++){let t=v[a];if(t.to<i&&t.from<i){let e=o.nodes[t.from],n=o.nodes[t.to],s=o.connect(e,n)[0];s.weight=t.weight,-1!==t.gater&&t.gater<i&&o.gate(o.nodes[t.gater],s)}}return o}}e.default=m},712:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(292)),s=o(n(799)),r=o(n(28)),a=n(483);class u{constructor(t){this.activation=0,this.derivative=0,this.state=0,this.old=0,this.mask=1,this.previousDeltaBias=0,this.totalDeltaBias=0,this.error={responsibility:0,projected:0,gated:0},this.bias=t===a.NodeTypeEnum.input?0:.2*Math.random()-.1,this.squash=s.default.activation.LOGISTIC,this.type=t||a.NodeTypeEnum.hidden,this.connections={in:[],out:[],gated:[],self:new i.default(this,this,0)}}activate(t){if(void 0!==t)return this.activation=t,this.activation;this.old=this.state,this.state=this.connections.self.gain*this.connections.self.weight*this.state+this.bias;for(let t=0;t<this.connections.in.length;t++){var e=this.connections.in[t];this.state+=e.from.activation*e.weight*e.gain}this.activation=this.squash(this.state)*this.mask,this.derivative=this.squash(this.state,!0);var n=[],o=[];for(let t=0;t<this.connections.gated.length;t++){let e=this.connections.gated[t],i=e.to,s=n.indexOf(i);s>-1?o[s]+=e.weight*e.from.activation:(n.push(i),o.push(e.weight*e.from.activation+(i.connections.self.gater===this?i.old:0))),e.gain=this.activation}for(let t=0;t<this.connections.in.length;t++){let e=this.connections.in[t];e.elegibility=this.connections.self.gain*this.connections.self.weight*e.elegibility+e.from.activation*e.gain;for(var i=0;i<n.length;i++){let t=n[i],s=o[i],r=e.xtrace.nodes.indexOf(t);r>-1?e.xtrace.values[r]=t.connections.self.gain*t.connections.self.weight*e.xtrace.values[r]+this.derivative*e.elegibility*s:(e.xtrace.nodes.push(t),e.xtrace.values.push(this.derivative*e.elegibility*s))}}return this.activation}noTraceActivate(t){if(void 0!==t)return this.activation=t,this.activation;var e;for(this.state=this.connections.self.gain*this.connections.self.weight*this.state+this.bias,e=0;e<this.connections.in.length;e++){var n=this.connections.in[e];this.state+=n.from.activation*n.weight*n.gain}for(this.activation=this.squash(this.state),e=0;e<this.connections.gated.length;e++)this.connections.gated[e].gain=this.activation;return this.activation}propagate(t=.3,e=0,n,o){let i=0;if(this.type===a.NodeTypeEnum.output)this.error.responsibility=this.error.projected=(o||0)-this.activation;else{for(let t=0;t<this.connections.out.length;t++){let e=this.connections.out[t];i+=e.to.error.responsibility*e.weight*e.gain}this.error.projected=this.derivative*i,i=0;for(let t=0;t<this.connections.gated.length;t++){let e=this.connections.gated[t],n=e.to,o=n.connections.self.gater===this?n.old:0;o+=e.weight*e.from.activation,i+=n.error.responsibility*o}this.error.gated=this.derivative*i,this.error.responsibility=this.error.projected+this.error.gated}if(this.type===a.NodeTypeEnum.constant)return;for(let o=0;o<this.connections.in.length;o++){let i=this.connections.in[o],r=this.error.projected*i.elegibility;for(var s=0;s<i.xtrace.nodes.length;s++){let t=i.xtrace.nodes[s],e=i.xtrace.values[s];r+=t.error.responsibility*e}let a=t*r*this.mask;i.totalDeltaWeight+=a,n&&(i.totalDeltaWeight+=e*i.previousDeltaWeight,i.weight+=i.totalDeltaWeight,i.previousDeltaWeight=i.totalDeltaWeight,i.totalDeltaWeight=0)}const r=t*this.error.responsibility;this.totalDeltaBias+=r,n&&(this.totalDeltaBias+=e*this.previousDeltaBias,this.bias+=this.totalDeltaBias,this.previousDeltaBias=this.totalDeltaBias,this.totalDeltaBias=0)}connect(t,e){const n=[];if(void 0!==t.bias)if(t===this)0!==this.connections.self.weight?r.default.warnings&&console.warn("This connection already exists!"):this.connections.self.weight=e||1,n.push(this.connections.self);else{if(this.isProjectingTo(t))throw new Error("Already projecting a connection to this node!");{let o=new i.default(this,t,e);t.connections.in.push(o),this.connections.out.push(o),n.push(o)}}else for(var o=0;o<t.nodes.length;o++){let s=new i.default(this,t.nodes[o],e);t.nodes[o].connections.in.push(s),this.connections.out.push(s),t.connections.in.push(s),n.push(s)}return n}disconnect(t,e){if(this!==t){for(let e=0;e<this.connections.out.length;e++){let n=this.connections.out[e];if(n.to===t){this.connections.out.splice(e,1);let t=n.to.connections.in.indexOf(n);n.to.connections.in.splice(t,1),null!==n.gater&&n.gater.ungate(n);break}}e&&t.disconnect(this)}else this.connections.self.weight=0}gate(t){Array.isArray(t)||(t=[t]);for(let e=0;e<t.length;e++){let n=t[e];this.connections.gated.push(n),n.gater=this}}ungate(t){Array.isArray(t)||(t=[t]);for(var e=t.length-1;e>=0;e--){var n=t[e],o=this.connections.gated.indexOf(n);this.connections.gated.splice(o,1),n.gater=null,n.gain=1}}clear(){for(var t=0;t<this.connections.in.length;t++){var e=this.connections.in[t];e.elegibility=0,e.xtrace={nodes:[],values:[]}}for(t=0;t<this.connections.gated.length;t++)this.connections.gated[t].gain=0;this.error.responsibility=this.error.projected=this.error.gated=0,this.old=this.state=this.activation=0}isProjectingTo(t){if(t===this&&0!==this.connections.self.weight)return!0;for(var e=0;e<this.connections.out.length;e++)if(this.connections.out[e].to===t)return!0;return!1}isProjectedBy(t){if(t===this&&0!==this.connections.self.weight)return!0;for(var e=0;e<this.connections.in.length;e++)if(this.connections.in[e].from===t)return!0;return!1}toJSON(){return{bias:this.bias,type:this.type,squash:this.squash.name,mask:this.mask}}static fromJSON(t){var e=new u;return e.bias=t.bias,e.type=t.type,e.mask=t.mask,e.squash=s.default.activation[t.squash],e}}e.default=u},28:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default={warnings:!1}},156:function(t,e,n){var o,i=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(e,n);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,o,i)}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=this&&this.__importStar||(o=function(t){return o=Object.getOwnPropertyNames||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[e.length]=n);return e},o(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n=o(t),r=0;r<n.length;r++)"default"!==n[r]&&i(e,t,n[r]);return s(e,t),e}),a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.multi=e.Neat=e.NodeElement=e.Layer=e.Group=e.config=e.Network=e.architect=e.Connection=e.methods=void 0;const u=a(n(799));e.methods=u.default;const l=a(n(292));e.Connection=l.default;const c=a(n(49));e.architect=c.default;const h=a(n(72));e.Network=h.default;const f=a(n(28));e.config=f.default;const d=a(n(33));e.Group=d.default;const p=a(n(864));e.Layer=p.default;const g=a(n(712));e.NodeElement=g.default;const v=a(n(582));e.Neat=v.default;const m=r(n(224));e.multi=m},297:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});const n={LOGISTIC:(t,e)=>{const n=1/(1+Math.exp(-t));return e?n*(1-n):n},TANH:function(t,e){return e?1-Math.pow(Math.tanh(t),2):Math.tanh(t)},IDENTITY:function(t,e){return e?1:t},STEP:function(t,e){return e?0:t>0?1:0},RELU:function(t,e){return e?t>0?1:0:t>0?t:0},SOFTSIGN:function(t,e){const n=1+Math.abs(t);return e?t/Math.pow(n,2):t/n},SINUSOID:function(t,e){return e?Math.cos(t):Math.sin(t)},GAUSSIAN:function(t,e){const n=Math.exp(-Math.pow(t,2));return e?-2*t*n:n},BENT_IDENTITY:function(t,e){const n=Math.sqrt(Math.pow(t,2)+1);return e?t/(2*n)+1:(n-1)/2+t},BIPOLAR:function(t,e){return e?0:t>0?1:-1},BIPOLAR_SIGMOID:function(t,e){const n=2/(1+Math.exp(-t))-1;return e?.5*(1+n)*(1-n):n},HARD_TANH:function(t,e){return e?t>-1&&t<1?1:0:Math.max(-1,Math.min(1,t))},ABSOLUTE:function(t,e){return e?t<0?-1:1:Math.abs(t)},INVERSE:function(t,e){return e?-1:1-t},SELU:function(t,e){const n=1.6732632423543772,o=1.0507009873554805,i=t>0?t:n*Math.exp(t)-n;return e?t>0?o:(i+n)*o:i*o}};e.default=n},497:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default={ALL_TO_ALL:{name:"OUTPUT"},ALL_TO_ELSE:{name:"INPUT"},ONE_TO_ONE:{name:"SELF"}}},756:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});const n={CROSS_ENTROPY:function(t,e){let n=0;for(let o=0;o<e.length;o++)n-=t[o]*Math.log(Math.max(e[o],1e-15))+(1-t[o])*Math.log(1-Math.max(e[o],1e-15));return n/e.length},MSE:function(t,e){let n=0;for(let o=0;o<e.length;o++)n+=Math.pow(t[o]-e[o],2);return n/e.length},BINARY:function(t,e){let n=0;for(let o=0;o<e.length;o++)n+=Number(Math.round(2*t[o])!==Math.round(2*e[o]));return n},MAE:function(t,e){for(var n=0,o=0;o<e.length;o++)n+=Math.abs(t[o]-e[o]);return n/e.length},MAPE:function(t,e){for(var n=0,o=0;o<e.length;o++)n+=Math.abs((e[o]-t[o])/Math.max(t[o],1e-15));return n/e.length},MSLE:function(t,e){for(var n=0,o=0;o<e.length;o++)n+=Math.log(Math.max(t[o],1e-15))-Math.log(Math.max(e[o],1e-15));return n},HINGE:function(t,e){for(var n=0,o=0;o<e.length;o++)n+=Math.max(0,1-t[o]*e[o]);return n}};e.default=n},843:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default={SINGLE_POINT:{name:"SINGLE_POINT",config:[.4]},TWO_POINT:{name:"TWO_POINT",config:[.4,.9]},UNIFORM:{name:"UNIFORM"},AVERAGE:{name:"AVERAGE"}}},353:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default={OUTPUT:{name:"OUTPUT"},INPUT:{name:"INPUT"},SELF:{name:"SELF"}}},799:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(297)),s=o(n(525)),r=o(n(959)),a=o(n(843)),u=o(n(756)),l=o(n(353)),c=o(n(497)),h=o(n(171));e.default={activation:i.default,mutation:s.default,selection:r.default,crossover:a.default,cost:u.default,gating:l.default,connection:c.default,rate:h.default}},827:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(28)),s={name:"ADD_BACK_CONN",callback(t){let e=[];for(let n=t.input;n<t.nodes.length;n++){let o=t.nodes[n];for(let i=t.input;i<n;i++){let n=t.nodes[i];o.isProjectingTo(n)||e.push([o,n])}}if(0===e.length)return void(i.default.warnings&&console.warn("No more connections to be made!"));let n=e[Math.floor(Math.random()*e.length)];t.connect(n[0],n[1])}};e.default=s},57:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(28)),s={name:"ADD_CONN",callback(t){let e=[];for(let n=0;n<t.nodes.length-t.output;n++){let o=t.nodes[n];for(let i=Math.max(n+1,t.input);i<t.nodes.length;i++){let n=t.nodes[i];o.isProjectingTo(n)||e.push([o,n])}}if(0===e.length)return void(i.default.warnings&&console.warn("No more connections to be made!"));let n=e[Math.floor(Math.random()*e.length)];t.connect(n[0],n[1])}};e.default=s},684:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(28)),s={name:"ADD_GATE",callback(t){let e=t.connections.concat(t.selfconns),n=[];for(let t=0;t<e.length;t++){let o=e[t];null===o.gater&&n.push(o)}if(0===n.length)return void(i.default.warnings&&console.warn("No more connections to gate!"));let o=Math.floor(Math.random()*(t.nodes.length-t.input)+t.input);const s=t.nodes[o];let r=n[Math.floor(Math.random()*n.length)];t.gate(s,r)}};e.default=s},183:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(712)),s=n(483),r=o(n(402)),a={name:"ADD_NODE",callback(t){let e=t.connections[Math.floor(Math.random()*t.connections.length)],n=e.gater;t.disconnect(e.from,e.to);let o=t.nodes.indexOf(e.to),a=new i.default(s.NodeTypeEnum.hidden);r.default.mutateNode(a);let u=Math.min(o,t.nodes.length-t.output);t.nodes.splice(u,0,a);let l=t.connect(e.from,a)[0],c=t.connect(a,e.to)[0];null!=n&&t.gate(n,Math.random()>=.5?l:c)}};e.default=a},308:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(28)),s={name:"ADD_SELF_CONN",callback(t){let e=[];for(let n=t.input;n<t.nodes.length;n++){let o=t.nodes[n];0===o.connections.self.weight&&e.push(o)}if(0===e.length)return void(i.default.warnings&&console.warn("No more self-connections to add!"));const n=e[Math.floor(Math.random()*e.length)];t.connect(n,n)}};e.default=s},525:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(183)),s=o(n(492)),r=o(n(57)),a=o(n(166)),u=o(n(798)),l=o(n(107)),c=o(n(402)),h=o(n(684)),f=o(n(571)),d=o(n(308)),p=o(n(293)),g=o(n(827)),v=o(n(406)),m=o(n(214)),_={ALL:[i.default,s.default,r.default,a.default,u.default,l.default,c.default,h.default,f.default,d.default,p.default,g.default,v.default,m.default],FFW:[i.default,s.default,r.default,a.default,u.default,l.default,c.default,m.default]};e.default=_},402:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(297)),s=o(n(28)),r={name:"MOD_ACTIVATION",callback(t){if(!this.mutateOutput&&t.input+t.output===t.nodes.length)return void(s.default.warnings&&console.warn("No nodes that allow mutation of activation function"));let e=Math.floor(Math.random()*(t.nodes.length-(this.mutateOutput?0:t.output)-t.input)+t.input);const n=t.nodes[e];this.mutateNode(n)},mutateNode(t){t.squash=this.allowed[(this.allowed.indexOf(t.squash)+Math.floor(Math.random()*(this.allowed.length-1))+1)%this.allowed.length]},mutateOutput:!0,allowed:[i.default.LOGISTIC,i.default.TANH,i.default.RELU,i.default.IDENTITY,i.default.STEP,i.default.SOFTSIGN,i.default.SINUSOID,i.default.GAUSSIAN,i.default.BENT_IDENTITY,i.default.BIPOLAR,i.default.BIPOLAR_SIGMOID,i.default.HARD_TANH,i.default.ABSOLUTE,i.default.INVERSE,i.default.SELU]};e.default=r},107:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});const n={name:"MOD_BIAS",callback(t){let e=Math.floor(Math.random()*(t.nodes.length-t.input)+t.input);const n=t.nodes[e];this.mutateNode(n)},mutateNode(t){let e=Math.random()*(this.max-this.min)+this.min;t.bias+=e},min:-1,max:1};e.default=n},798:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});const n={name:"MOD_WEIGHT",callback(t){let e=t.connections.concat(t.selfconns),n=e[Math.floor(Math.random()*e.length)],o=Math.random()*(this.max-this.min)+this.min;n.weight+=o},min:-1,max:1};e.default=n},406:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(28)),s={name:"SUB_BACK_CONN",callback(t){let e=[];for(let n=0;n<t.connections.length;n++){let o=t.connections[n];o.from.connections.out.length>1&&o.to.connections.in.length>1&&t.nodes.indexOf(o.from)>t.nodes.indexOf(o.to)&&e.push(o)}if(0===e.length)return void(i.default.warnings&&console.warn("No connections to remove!"));let n=e[Math.floor(Math.random()*e.length)];t.disconnect(n.from,n.to)}};e.default=s},166:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(28)),s={name:"SUB_CONN",callback(t){let e=[];for(let n=0;n<t.connections.length;n++){let o=t.connections[n];o.from.connections.out.length>1&&o.to.connections.in.length>1&&t.nodes.indexOf(o.to)>t.nodes.indexOf(o.from)&&e.push(o)}if(0===e.length)return void(i.default.warnings&&console.warn("No connections to remove!"));let n=e[Math.floor(Math.random()*e.length)];t.disconnect(n.from,n.to)}};e.default=s},571:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(28)),s={name:"SUB_GATE",callback(t){if(0===t.gates.length)return void(i.default.warnings&&console.warn("No more connections to ungate!"));let e=Math.floor(Math.random()*t.gates.length),n=t.gates[e];t.ungate(n)}};e.default=s},492:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(28)),s={name:"SUB_NODE",callback(t){if(t.nodes.length===t.input+t.output)return void(i.default.warnings&&console.warn("No more nodes left to remove!"));let e=Math.floor(Math.random()*(t.nodes.length-t.output-t.input)+t.input);t.remove(t.nodes[e])},keep_gates:!0};e.default=s},293:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(28)),s={name:"SUB_SELF_CONN",callback(t){if(0===t.selfconns.length)return void(i.default.warnings&&console.warn("No more self-connections to remove!"));const e=t.selfconns[Math.floor(Math.random()*t.selfconns.length)];t.disconnect(e.from,e.to)}};e.default=s},214:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(28)),s={name:"SWAP_NODES",callback(t){if(this.mutateOutput&&t.nodes.length-t.input<2||!this.mutateOutput&&t.nodes.length-t.input-t.output<2)return void(i.default.warnings&&console.warn("No nodes that allow swapping of bias and activation function"));let e=Math.floor(Math.random()*(t.nodes.length-(this.mutateOutput?0:t.output)-t.input)+t.input),n=t.nodes[e];e=Math.floor(Math.random()*(t.nodes.length-(this.mutateOutput?0:t.output)-t.input)+t.input);let o=t.nodes[e],s=n.bias,r=n.squash;n.bias=o.bias,n.squash=o.squash,o.bias=s,o.squash=r},mutateOutput:!0};e.default=s},171:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});const n={FIXED:()=>function(t){return t},STEP:(t=.9,e=100)=>(n,o)=>n*Math.pow(t,Math.floor(o/e)),EXP:(t=.999)=>(e,n)=>e*Math.pow(t,n),INV:(t=.001,e=2)=>function(n,o){return n*Math.pow(1+t*o,-e)}};e.default=n},959:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default={FITNESS_PROPORTIONATE:{name:"FITNESS_PROPORTIONATE"},POWER:{name:"POWER",power:4},TOURNAMENT:{name:"TOURNAMENT",size:5,probability:.5}}},224:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.activations=e.workers=void 0,e.serializeDataSet=function(t){for(var e=[t[0].input.length,t[0].output.length],n=0;n<t.length;n++){var o;for(o=0;o<e[0];o++)e.push(t[n].input[o]);for(o=0;o<e[1];o++)e.push(t[n].output[o])}return e},e.activateSerializedNetwork=s,e.deserializeDataSet=function(t){for(var e=[],n=t[0]+t[1],o=0;o<(t.length-2)/n;o++){let s=[];for(var i=2+o*n;i<2+o*n+t[0];i++)s.push(t[i]);let r=[];for(i=2+o*n+t[0];i<2+o*n+n;i++)r.push(t[i]);e.push(s),e.push(r)}return e},e.testSerializedSet=function(t,e,n,o,i,r){for(var a=0,u=0;u<t.length;u+=2){let l=s(t[u],n,o,i,r);a+=e(t[u+1],l)}return a/(t.length/2)};const i=o(n(801));function s(t,e,n,o,i){for(var s=0;s<o[0];s++)e[s]=t[s];for(s=2;s<o.length;s++){let t=o[s++],r=o[s++],a=o[s++],u=o[s++],l=o[s++];for(n[t]=(-1===l?1:e[l])*u*n[t]+r;-2!==o[s];)n[t]+=e[o[s++]]*o[s++]*(-1===o[s++]?1:e[o[s-1]]);e[t]=i[a](n[t])}var r=[];for(s=e.length-o[1];s<e.length;s++)r.push(e[s]);return r}e.workers=i.default,e.activations=[function(t){return 1/(1+Math.exp(-t))},function(t){return Math.tanh(t)},function(t){return t},function(t){return t>0?1:0},function(t){return t>0?t:0},function(t){return t/(1+Math.abs(t))},function(t){return Math.sin(t)},function(t){return Math.exp(-Math.pow(t,2))},function(t){return(Math.sqrt(Math.pow(t,2)+1)-1)/2+t},function(t){return t>0?1:-1},function(t){return 2/(1+Math.exp(-t))-1},function(t){return Math.max(-1,Math.min(1,t))},function(t){return Math.abs(t)},function(t){return 1-t},function(t){var e=1.6732632423543772;return 1.0507009873554805*(t>0?t:e*Math.exp(t)-e)}]},319:function(t,e,n){var o,i=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(e,n);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,o,i)}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=this&&this.__importStar||(o=function(t){return o=Object.getOwnPropertyNames||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[e.length]=n);return e},o(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n=o(t),r=0;r<n.length;r++)"default"!==n[r]&&i(e,t,n[r]);return s(e,t),e});Object.defineProperty(e,"__esModule",{value:!0});const a=r(n(224));e.default=class{constructor(t,e){var n=new Blob([this._createBlobString(e)]);this.url=window.URL.createObjectURL(n),this.worker=new Worker(this.url);var o={set:new Float64Array(t).buffer};this.worker.postMessage(o,[o.set])}evaluate(t){return new Promise((e=>{var n=t.serialize(),o={activations:new Float64Array(n[0]).buffer,states:new Float64Array(n[1]).buffer,conns:new Float64Array(n[2]).buffer};this.worker.onmessage=function(t){var n=new Float64Array(t.data.buffer)[0];e(n)},this.worker.postMessage(o,[o.activations,o.states,o.conns])}))}terminate(){this.worker.terminate(),window.URL.revokeObjectURL(this.url)}_createBlobString(t){return`\n      var F = [${a.activations.toString()}];\n      var cost = ${t.toString()};\n      var multi = {\n        deserializeDataSet: ${a.deserializeDataSet.toString()},\n        testSerializedSet: ${a.testSerializedSet.toString()},\n        activateSerializedNetwork: ${a.activateSerializedNetwork.toString()}\n      };\n\n      this.onmessage = function (e) {\n        if(typeof e.data.set === 'undefined'){\n          var A = new Float64Array(e.data.activations);\n          var S = new Float64Array(e.data.states);\n          var data = new Float64Array(e.data.conns);\n\n          var error = multi.testSerializedSet(set, cost, A, S, data, F);\n\n          var answer = { buffer: new Float64Array([error ]).buffer };\n          postMessage(answer, [answer.buffer]);\n        } else {\n          set = multi.deserializeDataSet(new Float64Array(e.data.set));\n        }\n      };`}}},445:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(660)),s=o(n(975));e.default=class{constructor(t,e){this.worker=i.default.fork(s.default.join(__dirname,"/worker")),this.worker.send({set:t,cost:e.name})}evaluate(t){return new Promise((e=>{var n=t.serialize(),o={activations:n[0],states:n[1],conns:n[2]},i=this.worker;this.worker.on("message",(function t(n){i.removeListener("message",t),e(n)})),this.worker.send(o)}))}terminate(){this.worker.kill()}}},801:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(445)),s=o(n(319));var r={node:{TestWorker:i.default},browser:{TestWorker:s.default}};e.default=r},582:function(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(i,s){function r(t){try{u(o.next(t))}catch(t){s(t)}}function a(t){try{u(o.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}u((o=o.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(72)),r=i(n(799)),a=i(n(28)),u=i(n(183)),l=i(n(57)),c=i(n(684));var h=r.default.selection;e.default=class{constructor(t,e,n,o){this.population=[],this.input=t,this.output=e,this.fitness=n,o=o||{},this.equal=o.equal||!1,this.clear=o.clear||!1,this.popsize=o.popsize||50,this.elitism=o.elitism||0,this.provenance=o.provenance||0,this.mutationRate=o.mutationRate||.3,this.mutationAmount=o.mutationAmount||1,this.fitnessPopulation=o.fitnessPopulation||!1,this.selection=o.selection||r.default.selection.POWER,this.crossover=o.crossover||[r.default.crossover.SINGLE_POINT,r.default.crossover.TWO_POINT,r.default.crossover.UNIFORM,r.default.crossover.AVERAGE],this.mutation=o.mutation||r.default.mutation.FFW,this.template=o.network||!1,this.maxNodes=o.maxNodes||1/0,this.maxConns=o.maxConns||1/0,this.maxGates=o.maxGates||1/0,this.selectMutationMethod="function"==typeof o.mutationSelection?o.mutationSelection.bind(this):this.selectMutationMethod,this.generation=0,this.createPool(this.template)}createPool(t){this.population=[];for(var e=0;e<this.popsize;e++){var n;(n=this.template?s.default.fromJSON(t.toJSON()):new s.default(this.input,this.output)).score=void 0,this.population.push(n)}}evolve(){return o(this,void 0,void 0,(function*(){void 0===this.population[this.population.length-1].score&&(yield this.evaluate()),this.sort();var t=s.default.fromJSON(this.population[0].toJSON());t.score=this.population[0].score;for(var e=[],n=[],o=0;o<this.elitism;o++)n.push(this.population[o]);for(o=0;o<this.provenance;o++)e.push(s.default.fromJSON(this.template.toJSON()));for(o=0;o<this.popsize-this.elitism-this.provenance;o++)e.push(this.getOffspring());for(this.population=e,this.mutate(),this.population.push(...n),o=0;o<this.population.length;o++)this.population[o].score=void 0;return this.generation++,t}))}getOffspring(){var t=this.getParent(),e=this.getParent();return s.default.crossOver(t,e,this.equal)}selectMutationMethod(t){var e=this.mutation[Math.floor(Math.random()*this.mutation.length)];if(e===u.default&&t.nodes.length>=this.maxNodes)a.default.warnings&&console.warn("maxNodes exceeded!");else if(e===l.default&&t.connections.length>=this.maxConns)a.default.warnings&&console.warn("maxConns exceeded!");else{if(!(e===c.default&&t.gates.length>=this.maxGates))return e;a.default.warnings&&console.warn("maxGates exceeded!")}}mutate(){for(var t=0;t<this.population.length;t++)if(Math.random()<=this.mutationRate)for(var e=0;e<this.mutationAmount;e++){const e=this.selectMutationMethod(this.population[t]);this.population[t].mutate(e)}}evaluate(){return o(this,void 0,void 0,(function*(){var t;if(this.fitnessPopulation){if(this.clear)for(t=0;t<this.population.length;t++)this.population[t].clear();yield this.fitness(this.population)}else for(t=0;t<this.population.length;t++){var e=this.population[t];this.clear&&e.clear(),e.score=yield this.fitness(e)}}))}sort(){this.population.sort((function(t,e){return e.score-t.score}))}getFittest(){return void 0===this.population[this.population.length-1].score&&this.evaluate(),this.population[0].score<this.population[1].score&&this.sort(),this.population[0]}getAverage(){void 0===this.population[this.population.length-1].score&&this.evaluate();for(var t=0,e=0;e<this.population.length;e++)t+=this.population[e].score;return t/this.population.length}getParent(){var t;switch(this.selection){case h.POWER:this.population[0].score<this.population[1].score&&this.sort();var e=Math.floor(Math.pow(Math.random(),this.selection.power)*this.population.length);return this.population[e];case h.FITNESS_PROPORTIONATE:var n=0,o=0;for(t=0;t<this.population.length;t++){var i=this.population[t].score;o=i<o?i:o,n+=i}n+=(o=Math.abs(o))*this.population.length;var s=Math.random()*n,r=0;for(t=0;t<this.population.length;t++){let e=this.population[t];if(s<(r+=e.score+o))return e}return this.population[Math.floor(Math.random()*this.population.length)];case h.TOURNAMENT:if(this.selection.size>this.popsize)throw new Error("Your tournament size should be lower than the population size, please change methods.selection.TOURNAMENT.size");var a=[];for(t=0;t<this.selection.size;t++){let t=this.population[Math.floor(Math.random()*this.population.length)];a.push(t)}for(a.sort((function(t,e){return e.score-t.score})),t=0;t<this.selection.size;t++)if(Math.random()<this.selection.probability||t===this.selection.size-1)return a[t]}}export(){for(var t=[],e=0;e<this.population.length;e++){var n=this.population[e];t.push(n.toJSON())}return t}import(t){for(var e=[],n=0;n<t.length;n++){var o=t[n];e.push(s.default.fromJSON(o))}this.population=e,this.popsize=e.length}}},483:(t,e)=>{var n;Object.defineProperty(e,"__esModule",{value:!0}),e.NodeTypeEnum=void 0,function(t){t.input="input",t.hidden="hidden",t.output="output",t.constant="constant"}(n||(e.NodeTypeEnum=n={}))},660:e=>{e.exports=t},234:t=>{t.exports=e}},o={};return function t(e){var i=o[e];if(void 0!==i)return i.exports;var s=o[e]={exports:{}};return n[e].call(s.exports,s,s.exports,t),s.exports}(156)})()));